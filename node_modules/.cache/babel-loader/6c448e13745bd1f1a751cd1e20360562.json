{"ast":null,"code":"import _slicedToArray from \"/home/russ/Documents/spotify/spotify-react-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/home/russ/Documents/spotify/spotify-react-demo/src/index.js\",\n    _this = this;\n\nimport React, { useEffect, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport { setSpotifyAccess, setSpotifyAccessToken, setSpotifyTokenExpirationTime } from './LocalStorageData';\nimport { SpotifyAccess } from './SpotifyAccess';\nimport { getTokenFromResponse } from './login/spotify'; // const hashStr = window.location.hash; // everything in address after #, here spotify puts successfull auth tokens\n// const searchStr = window.location.search; // everything in address after ?, here spotify puts access denials\n// const hashParams = decodeHashParams(hashStr.slice(1, hashStr.length));\n// const searchParams = decodeHashParams(searchStr.slice(1, searchStr.length));\n\nvar hash = getTokenFromResponse();\nconsole.log('hash useEff:', hash); //after get access token, clear from url\n\nwindow.location.hash = '';\nsetToken(hash.access_token); // console.log('hash',hashParams.access_token)\n// if (hashParams.access_token) {\n//     console.log('access', hashParams.access_token)\n//     setSpotifyAccess(SpotifyAccess.ALLOWED);\n//     setSpotifyAccessToken(hashParams.access_token);\n//     setSpotifyTokenExpirationTime(hashParams.expires_in);\n//     window.close();\n// } else if (searchParams.error) {\n//     setSpotifyAccess(SpotifyAccess.DENIED);\n//     window.close();\n// } else {\n//     ReactDOM.render(<App />, document.getElementById('root'));\n// }\n\nif (hashParams.access_token) {\n  console.log('access', hashParams.access_token);\n  setSpotifyAccess(SpotifyAccess.ALLOWED);\n  setSpotifyAccessToken(hashParams.access_token);\n  setSpotifyTokenExpirationTime(hashParams.expires_in);\n  window.close();\n} else if (searchParams.error) {\n  setSpotifyAccess(SpotifyAccess.DENIED);\n  window.close();\n} else {\n  ReactDOM.render( /*#__PURE__*/React.createElement(App, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 21\n    }\n  }), document.getElementById('root'));\n}\n/**\n * decodes a parameter string (p1=v1&p2=v2&... syntax) into the object {p1: v1, p2: v2, ...}\n */\n\n\nvar decodeHashParams = function decodeHashParams() {\n  console.log('on decodedHash');\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      token = _useState2[0],\n      setToken = _useState2[1];\n\n  useEffect(function () {\n    console.log('useEffect');\n    var hash = getTokenFromResponse();\n    console.log('hash useEff:', hash); //after get access token, clear from url\n\n    window.location.hash = '';\n    setToken(hash.access_token);\n  }, []); // console.log('in index')\n  // const hashParams: { [key: string]: string } = {};\n  // const a = /\\+/g;  // Regex for replacing addition symbol with a space\n  // const r = /([^&;=]+)=?([^&;]*)/g;\n  // const d = (s: string) => decodeURIComponent(s.replace(a, \" \"));\n  // let e;\n  // while (e = r.exec(str)) {\n  //     hashParams[d(e[1])] = d(e[2]);\n  // }\n\n  return /*#__PURE__*/React.createElement(App, {\n    token: token,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 10\n    }\n  });\n};\n\nexport default decodeHashParams;","map":{"version":3,"sources":["/home/russ/Documents/spotify/spotify-react-demo/src/index.js"],"names":["React","useEffect","useState","ReactDOM","App","setSpotifyAccess","setSpotifyAccessToken","setSpotifyTokenExpirationTime","SpotifyAccess","getTokenFromResponse","hash","console","log","window","location","setToken","access_token","hashParams","ALLOWED","expires_in","close","searchParams","error","DENIED","render","document","getElementById","decodeHashParams","token"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,GAAP,MAAgB,OAAhB;AACA,SACEC,gBADF,EAEEC,qBAFF,EAGEC,6BAHF,QAIO,oBAJP;AAKA,SAASC,aAAT,QAA8B,iBAA9B;AACA,SAASC,oBAAT,QAAqC,iBAArC,C,CAEA;AACA;AACA;AACA;;AACA,IAAMC,IAAI,GAAGD,oBAAoB,EAAjC;AACAE,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BF,IAA5B,E,CACI;;AACAG,MAAM,CAACC,QAAP,CAAgBJ,IAAhB,GAAuB,EAAvB;AACAK,QAAQ,CAACL,IAAI,CAACM,YAAN,CAAR,C,CACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,UAAU,CAACD,YAAf,EAA6B;AACzBL,EAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBK,UAAU,CAACD,YAAjC;AACAX,EAAAA,gBAAgB,CAACG,aAAa,CAACU,OAAf,CAAhB;AACAZ,EAAAA,qBAAqB,CAACW,UAAU,CAACD,YAAZ,CAArB;AACAT,EAAAA,6BAA6B,CAACU,UAAU,CAACE,UAAZ,CAA7B;AACAN,EAAAA,MAAM,CAACO,KAAP;AACH,CAND,MAMO,IAAIC,YAAY,CAACC,KAAjB,EAAwB;AAC3BjB,EAAAA,gBAAgB,CAACG,aAAa,CAACe,MAAf,CAAhB;AACAV,EAAAA,MAAM,CAACO,KAAP;AACH,CAHM,MAGA;AACHjB,EAAAA,QAAQ,CAACqB,MAAT,eAAgB,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAhB,EAAyBC,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAAzB;AACH;AACD;AACA;AACA;;;AACA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAC7BhB,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;;AAD6B,kBAEHV,QAAQ,EAFL;AAAA;AAAA,MAEtB0B,KAFsB;AAAA,MAEfb,QAFe;;AAG7Bd,EAAAA,SAAS,CAAC,YAAM;AACdU,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACA,QAAMF,IAAI,GAAGD,oBAAoB,EAAjC;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BF,IAA5B,EAHc,CAId;;AACAG,IAAAA,MAAM,CAACC,QAAP,CAAgBJ,IAAhB,GAAuB,EAAvB;AACAK,IAAAA,QAAQ,CAACL,IAAI,CAACM,YAAN,CAAR;AACD,GAPQ,EAON,EAPM,CAAT,CAH6B,CAY7B;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;AACA,sBAAO,oBAAC,GAAD;AAAK,IAAA,KAAK,EAAEY,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AACD,CAvBD;;AAwBA,eAAeD,gBAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport {\n  setSpotifyAccess,\n  setSpotifyAccessToken,\n  setSpotifyTokenExpirationTime,\n} from './LocalStorageData';\nimport { SpotifyAccess } from './SpotifyAccess';\nimport { getTokenFromResponse } from './login/spotify';\n\n// const hashStr = window.location.hash; // everything in address after #, here spotify puts successfull auth tokens\n// const searchStr = window.location.search; // everything in address after ?, here spotify puts access denials\n// const hashParams = decodeHashParams(hashStr.slice(1, hashStr.length));\n// const searchParams = decodeHashParams(searchStr.slice(1, searchStr.length));\nconst hash = getTokenFromResponse();\nconsole.log('hash useEff:', hash);\n    //after get access token, clear from url\n    window.location.hash = '';\n    setToken(hash.access_token);\n// console.log('hash',hashParams.access_token)\n// if (hashParams.access_token) {\n//     console.log('access', hashParams.access_token)\n//     setSpotifyAccess(SpotifyAccess.ALLOWED);\n//     setSpotifyAccessToken(hashParams.access_token);\n//     setSpotifyTokenExpirationTime(hashParams.expires_in);\n//     window.close();\n// } else if (searchParams.error) {\n//     setSpotifyAccess(SpotifyAccess.DENIED);\n//     window.close();\n// } else {\n//     ReactDOM.render(<App />, document.getElementById('root'));\n// }\nif (hashParams.access_token) {\n    console.log('access', hashParams.access_token)\n    setSpotifyAccess(SpotifyAccess.ALLOWED);\n    setSpotifyAccessToken(hashParams.access_token);\n    setSpotifyTokenExpirationTime(hashParams.expires_in);\n    window.close();\n} else if (searchParams.error) {\n    setSpotifyAccess(SpotifyAccess.DENIED);\n    window.close();\n} else {\n    ReactDOM.render(<App />, document.getElementById('root'));\n}\n/**\n * decodes a parameter string (p1=v1&p2=v2&... syntax) into the object {p1: v1, p2: v2, ...}\n */\nconst decodeHashParams = () => {\n  console.log('on decodedHash');\n  const [token, setToken] = useState();\n  useEffect(() => {\n    console.log('useEffect');\n    const hash = getTokenFromResponse();\n    console.log('hash useEff:', hash);\n    //after get access token, clear from url\n    window.location.hash = '';\n    setToken(hash.access_token);\n  }, []);\n\n  // console.log('in index')\n  // const hashParams: { [key: string]: string } = {};\n  // const a = /\\+/g;  // Regex for replacing addition symbol with a space\n  // const r = /([^&;=]+)=?([^&;]*)/g;\n  // const d = (s: string) => decodeURIComponent(s.replace(a, \" \"));\n  // let e;\n\n  // while (e = r.exec(str)) {\n  //     hashParams[d(e[1])] = d(e[2]);\n  // }\n  return <App token={token} />;\n};\nexport default decodeHashParams;\n"]},"metadata":{},"sourceType":"module"}